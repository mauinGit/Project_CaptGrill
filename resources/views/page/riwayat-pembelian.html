<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Riwayat Pembelian - CAPT.grill</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bitter:wght@600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#1a5939',
            secondary: '#ffde59',
          },
          fontFamily: {
            'bitter': ['Bitter', 'serif'],
          }
        }
      }
    }
  </script>
  <style>
    .bitter-semibold {
      font-family: 'Bitter', serif;
      font-weight: 600;
    }
    .bitter-bold {
      font-family: 'Bitter', serif;
      font-weight: 700;
    }
    
    .stats-card {
      transition: all 0.3s ease;
    }
    
    .stats-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }
    
    .menu-item {
      transition: all 0.2s ease;
    }
    
    .menu-item:hover {
      transform: scale(1.02);
    }
    
    .sidebar-btn {
      transition: all 0.3s ease;
    }
    
    .sidebar-btn:hover {
      background-color: rgba(26, 89, 57, 0.1);
    }
    
    /* Mobile sidebar styles */
    @media (max-width: 1023px) {
      .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        position: fixed;
        height: 100vh;
        z-index: 40;
        top: 0;
        left: 0;
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 30;
      }
      
      .overlay.active {
        display: block;
      }
    }
    
    @media (min-width: 1024px) {
      .mobile-menu-btn {
        display: none;
      }
      
      .overlay {
        display: none !important;
      }
      
      .close-btn {
        display: none;
      }
    }
    
    /* Custom table styles */
    .table-container {
      overflow-x: auto;
    }
    
    .table-container table {
      min-width: 800px;
    }
    
    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 50;
      align-items: center;
      justify-content: center;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      max-width: 90%;
      width: 600px;
      max-height: 90vh;
      overflow-y: auto;
    }
  </style>
</head>

<body class="bg-primary min-h-screen">
  <!-- Mobile Menu Button -->
  <button class="mobile-menu-btn fixed top-4 left-4 z-50 bg-secondary p-3 rounded-lg shadow-lg lg:hidden">
    <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
    </svg>
  </button>

  <!-- Overlay for mobile -->
  <div class="overlay"></div>

  <div class="flex">
    <!-- Sidebar -->
    <aside class="sidebar w-64 bg-secondary p-6 min-h-screen lg:min-h-0 lg:static lg:transform-none">
      <!-- Close button for mobile -->
      <button class="close-btn absolute top-4 right-4 text-primary lg:hidden">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>

      <!-- Logo -->
      <div class="text-center mb-8 mt-8 lg:mt-0">
        <img src="logo.png" class="w-50 h-auto mx-auto" alt="CAPILogrill" />
      </div>

      <!-- Navigation -->
      <nav class="text-primary space-y-2">
        <a href="kasir.html" class="sidebar-btn block w-full text-left px-4 py-3 rounded-xl bitter-semibold text-lg hover:bg-primary hover:bg-opacity-10 transition-colors duration-300">
          Kasir
        </a>
        <div class="bg-primary text-secondary px-4 py-3 rounded-xl font-semibold bitter-semibold text-lg">
          Riwayat Pembelian
        </div>
      </nav>
      
      <!-- Logout -->
      <div class="mt-8 text-center">
        <a href="login.html" class="text-primary hover:text-green-800 font-semibold bitter-semibold text-lg transition-colors duration-300">
          Logout
        </a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="flex-1 p-4 lg:p-8 min-h-screen">
      
      <!-- Header -->
      <div class="bg-secondary rounded-2xl p-6 shadow-xl mb-8">
        <h1 class="text-primary font-bold text-2xl lg:text-4xl bitter-bold">
          Riwayat Pembelian
        </h1>
      </div>

      <!-- Date Filter -->
      <div class="bg-secondary rounded-2xl p-6 shadow-xl mb-8">
        <h2 class="text-primary font-bold text-xl lg:text-2xl bitter-bold mb-4">
          Filter Tanggal
        </h2>
        <div class="flex flex-col md:flex-row gap-4">
          <div class="flex-1">
            <label class="block text-primary font-semibold mb-2 bitter-semibold">Dari Tanggal</label>
            <input type="date" id="start-date" class="w-full p-3 rounded-lg border border-primary bg-white text-primary">
          </div>
          <div class="flex-1">
            <label class="block text-primary font-semibold mb-2 bitter-semibold">Sampai Tanggal</label>
            <input type="date" id="end-date" class="w-full p-3 rounded-lg border border-primary bg-white text-primary">
          </div>
          <div class="flex items-end">
            <button id="filter-btn" class="bg-primary text-secondary px-6 py-3 rounded-lg font-semibold bitter-semibold hover:bg-green-800 transition-colors">
              Tampilkan
            </button>
          </div>
        </div>
      </div>

      <!-- Search and Controls -->
      <div class="bg-secondary rounded-2xl p-6 shadow-xl mb-8">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
          <div class="flex-1 w-full">
            <div class="relative">
              <input type="text" id="search-input" placeholder="Cari nama customer atau pesanan..." class="w-full p-3 pl-10 rounded-lg border border-primary bg-white text-primary">
              <svg class="absolute left-3 top-3.5 w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
              </svg>
            </div>
          </div>
          <div class="flex gap-2">
            <div class="flex items-center gap-2">
              <label class="text-primary font-semibold bitter-semibold">Tampilkan:</label>
              <select id="rows-per-page" class="bg-white text-primary p-2 rounded-lg border border-primary">
                <option value="5">5 baris</option>
                <option value="10" selected>10 baris</option>
                <option value="20">20 baris</option>
                <option value="50">50 baris</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <!-- Table -->
      <div class="bg-secondary rounded-2xl p-6 shadow-xl mb-8">
        <div class="table-container">
          <table class="w-full text-primary">
            <thead>
              <tr class="border-b-2 border-primary">
                <th class="text-left py-3 px-4 font-bold bitter-bold">No.</th>
                <th class="text-left py-3 px-4 font-bold bitter-bold">Tanggal</th>
                <th class="text-left py-3 px-4 font-bold bitter-bold">Nama Customer</th>
                <th class="text-left py-3 px-4 font-bold bitter-bold">Pesanan</th>
                <th class="text-left py-3 px-4 font-bold bitter-bold">Total (Rp)</th>
              </tr>
            </thead>
            <tbody id="table-body">
              <!-- Data akan diisi oleh JavaScript -->
            </tbody>
            <tfoot>
              <tr class="bg-primary bg-opacity-10">
                <td class="py-3 px-4 font-bold bitter-bold" colspan="4">Total Halaman Ini</td>
                <td class="py-3 px-4 font-bold bitter-bold" id="page-total">0</td>
              </tr>
            </tfoot>
          </table>
        </div>

        <!-- Pagination -->
        <div class="flex flex-col md:flex-row justify-between items-center mt-6 pt-4 border-t border-primary border-opacity-20">
          <div class="text-primary mb-4 md:mb-0">
            Menampilkan <span id="showing-start">1</span> - <span id="showing-end">10</span> dari <span id="total-rows">75</span> data
          </div>
          <div class="flex items-center gap-2" id="pagination-container">
            <!-- Pagination akan diisi oleh JavaScript -->
          </div>
        </div>
      </div>

    </main>
  </div>

  <!-- Modal Detail Pesanan -->
  <div id="detail-pesanan-modal" class="modal">
    <div class="modal-content bg-secondary rounded-2xl p-6 shadow-xl">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-primary font-bold text-2xl bitter-bold">Detail Pesanan</h2>
        <button id="close-modal" class="text-primary hover:text-green-800 transition-colors">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      
      <div class="mb-4">
        <p class="text-primary font-semibold bitter-semibold">No. Transaksi: <span id="transaksi-id" class="font-normal">1</span></p>
        <p class="text-primary font-semibold bitter-semibold">Tanggal: <span id="transaksi-tanggal" class="font-normal">11-11-2025 15:28:40</span></p>
        <p class="text-primary font-semibold bitter-semibold">Customer: <span id="transaksi-customer" class="font-normal">Radit</span></p>
      </div>
      
      <div class="mb-6">
        <h3 class="text-primary font-bold text-xl bitter-bold mb-3">Daftar Pesanan</h3>
        <div id="daftar-pesanan" class="space-y-2">
          <!-- Daftar pesanan akan diisi oleh JavaScript -->
        </div>
      </div>
      
      <div class="flex justify-between items-center pt-4 border-t border-primary border-opacity-20">
        <p class="text-primary font-bold text-xl bitter-bold">Total</p>
        <p id="transaksi-total" class="text-primary font-bold text-xl bitter-bold">Rp 25.000</p>
      </div>
    </div>
  </div>

  <script>
    // Data contoh untuk tabel (20 data dengan tanggal yang berbeda)
    const sampleData = [
      { id: 1, tanggal: "2025-11-11 15:28:40", customer: "Radit", total: 25000 },
      { id: 2, tanggal: "2025-11-11 15:20:40", customer: "Rafael", total: 25000 },
      { id: 3, tanggal: "2025-11-11 15:15:40", customer: "Antasena", total: 10000 },
      { id: 4, tanggal: "2025-11-11 15:00:40", customer: "Gulrom", total: 40000 },
      { id: 5, tanggal: "2025-11-11 15:00:40", customer: "Dwianto", total: 35000 },
      { id: 6, tanggal: "2025-11-10 14:45:20", customer: "Sari", total: 45000 },
      { id: 7, tanggal: "2025-11-10 14:30:15", customer: "Budi", total: 30000 },
      { id: 8, tanggal: "2025-11-10 14:20:10", customer: "Lina", total: 20000 },
      { id: 9, tanggal: "2025-11-10 14:10:05", customer: "Ahmad", total: 55000 },
      { id: 10, tanggal: "2025-11-10 13:55:30", customer: "Dewi", total: 15000 },
      { id: 11, tanggal: "2025-11-09 16:40:25", customer: "Rizky", total: 32000 },
      { id: 12, tanggal: "2025-11-09 16:25:18", customer: "Maya", total: 28000 },
      { id: 13, tanggal: "2025-11-09 16:10:12", customer: "Hendra", total: 42000 },
      { id: 14, tanggal: "2025-11-09 15:55:08", customer: "Fitri", total: 18000 },
      { id: 15, tanggal: "2025-11-09 15:40:04", customer: "Joko", total: 37000 },
      { id: 16, tanggal: "2025-11-08 17:30:45", customer: "Siti", total: 29000 },
      { id: 17, tanggal: "2025-11-08 17:15:38", customer: "Rudi", total: 51000 },
      { id: 18, tanggal: "2025-11-08 17:00:32", customer: "Nina", total: 23000 },
      { id: 19, tanggal: "2025-11-08 16:45:27", customer: "Ari", total: 34000 },
      { id: 20, tanggal: "2025-11-08 16:30:22", customer: "Dian", total: 19000 }
    ];

    // Sample data for orders
    const pesananData = {
      1: {
        id: "TRX-001",
        tanggal: "11-11-2025 15:28:40",
        customer: "Radit",
        items: [
          { name: "Kebab Regular", price: 15000, qty: 1 },
          { name: "Lemonade Blast", price: 10000, qty: 1 }
        ],
        total: 25000
      },
      2: {
        id: "TRX-002",
        tanggal: "11-11-2025 15:20:40",
        customer: "Rafael",
        items: [
          { name: "Burger Special", price: 20000, qty: 1 },
          { name: "French Fries", price: 5000, qty: 1 }
        ],
        total: 25000
      },
      3: {
        id: "TRX-003",
        tanggal: "11-11-2025 15:15:40",
        customer: "Antasena",
        items: [
          { name: "Hotdog", price: 10000, qty: 1 }
        ],
        total: 10000
      },
      4: {
        id: "TRX-004",
        tanggal: "11-11-2025 15:00:40",
        customer: "Gulrom",
        items: [
          { name: "Sloppy Sandwich", price: 18000, qty: 1 },
          { name: "Bakso Bakar", price: 12000, qty: 1 },
          { name: "Lemonade Blast", price: 10000, qty: 1 }
        ],
        total: 40000
      },
      5: {
        id: "TRX-005",
        tanggal: "11-11-2025 15:00:40",
        customer: "Dwianto",
        items: [
          { name: "Kebab Jumbo", price: 20000, qty: 1 },
          { name: "Burger Regular", price: 15000, qty: 1 }
        ],
        total: 35000
      }
    };

    // Mobile menu functionality
    document.addEventListener('DOMContentLoaded', function() {
      const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
      const sidebar = document.querySelector('.sidebar');
      const overlay = document.querySelector('.overlay');
      const closeBtn = document.querySelector('.close-btn');
      
      // Open sidebar
      mobileMenuBtn.addEventListener('click', function() {
        sidebar.classList.add('active');
        overlay.classList.add('active');
      });
      
      // Close sidebar
      closeBtn.addEventListener('click', function() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
      
      // Close sidebar with overlay
      overlay.addEventListener('click', function() {
        sidebar.classList.remove('active');
        overlay.classList.remove('active');
      });
      
      // Close sidebar when clicking navigation links on mobile
      const navLinks = document.querySelectorAll('.sidebar a');
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (window.innerWidth < 1024) {
            sidebar.classList.remove('active');
            overlay.classList.remove('active');
          }
        });
      });
      
      // Modal functionality
      const modal = document.getElementById('detail-pesanan-modal');
      const closeModalBtn = document.getElementById('close-modal');
      
      // Close modal
      closeModalBtn.addEventListener('click', function() {
        modal.classList.remove('active');
      });
      
      // Close modal when clicking outside
      modal.addEventListener('click', function(e) {
        if (e.target === modal) {
          modal.classList.remove('active');
        }
      });
      
      // Load pesanan data to modal
      function loadPesananData(id) {
        const data = pesananData[id];
        if (!data) return;
        
        document.getElementById('transaksi-id').textContent = data.id;
        document.getElementById('transaksi-tanggal').textContent = data.tanggal;
        document.getElementById('transaksi-customer').textContent = data.customer;
        document.getElementById('transaksi-total').textContent = `Rp ${data.total.toLocaleString('id-ID')}`;
        
        const daftarPesanan = document.getElementById('daftar-pesanan');
        daftarPesanan.innerHTML = '';
        
        data.items.forEach(item => {
          const itemElement = document.createElement('div');
          itemElement.className = 'flex justify-between items-center py-2 border-b border-primary border-opacity-10';
          itemElement.innerHTML = `
            <div>
              <p class="text-primary font-medium">${item.name}</p>
              <p class="text-primary text-sm">${item.qty} x Rp ${item.price.toLocaleString('id-ID')}</p>
            </div>
            <p class="text-primary font-semibold">Rp ${(item.price * item.qty).toLocaleString('id-ID')}</p>
          `;
          daftarPesanan.appendChild(itemElement);
        });
      }
      
      // Table functionality
      let currentPage = 1;
      let rowsPerPage = 10;
      let filteredData = [...sampleData];
      
      // Format tanggal untuk tampilan
      function formatTanggal(tanggal) {
        const date = new Date(tanggal);
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const year = date.getFullYear();
        const hours = String(date.getHours()).padStart(2, '0');
        const minutes = String(date.getMinutes()).padStart(2, '0');
        const seconds = String(date.getSeconds()).padStart(2, '0');
        
        return `${day}-${month}-${year} ${hours}:${minutes}:${seconds}`;
      }
      
      // Initialize table
      function initTable() {
        renderTable();
        updatePagination();
        updateShowingInfo();
      }
      
      // Render table rows
      function renderTable() {
        const tableBody = document.getElementById('table-body');
        tableBody.innerHTML = '';
        
        const startIndex = (currentPage - 1) * rowsPerPage;
        const endIndex = startIndex + rowsPerPage;
        const pageData = filteredData.slice(startIndex, endIndex);
        
        let pageTotal = 0;
        
        pageData.forEach((item, index) => {
          const row = document.createElement('tr');
          row.className = 'border-b border-primary border-opacity-20 hover:bg-primary hover:bg-opacity-10 transition-colors';
          row.innerHTML = `
            <td class="py-3 px-4">${startIndex + index + 1}</td>
            <td class="py-3 px-4">${formatTanggal(item.tanggal)}</td>
            <td class="py-3 px-4">${item.customer}</td>
            <td class="py-3 px-4">
              <button class="lihat-pesanan-btn text-primary font-semibold underline hover:text-green-800 transition-colors" data-id="${item.id}">
                Lihat Pesanan
              </button>
            </td>
            <td class="py-3 px-4">${item.total.toLocaleString('id-ID')}</td>
          `;
          tableBody.appendChild(row);
          pageTotal += item.total;
        });
        
        // Update page total
        document.getElementById('page-total').textContent = pageTotal.toLocaleString('id-ID');
        
        // Add event listeners to lihat pesanan buttons
        const lihatPesananBtns = document.querySelectorAll('.lihat-pesanan-btn');
        lihatPesananBtns.forEach(btn => {
          btn.addEventListener('click', function() {
            const id = this.getAttribute('data-id');
            loadPesananData(id);
            modal.classList.add('active');
          });
        });
      }
      
      // Update pagination
      function updatePagination() {
        const totalPages = Math.ceil(filteredData.length / rowsPerPage);
        const paginationContainer = document.getElementById('pagination-container');
        paginationContainer.innerHTML = '';
        
        // Previous button
        if (currentPage > 1) {
          const prevBtn = document.createElement('button');
          prevBtn.className = 'pagination-btn bg-white text-primary px-3 py-2 rounded-lg font-semibold bitter-semibold hover:bg-primary hover:bg-opacity-10 transition-colors';
          prevBtn.innerHTML = `
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
          `;
          prevBtn.addEventListener('click', () => {
            currentPage--;
            initTable();
          });
          paginationContainer.appendChild(prevBtn);
        }
        
        // Page buttons
        const maxVisiblePages = 5;
        let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
        let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
        
        if (endPage - startPage + 1 < maxVisiblePages) {
          startPage = Math.max(1, endPage - maxVisiblePages + 1);
        }
        
        for (let i = startPage; i <= endPage; i++) {
          const pageBtn = document.createElement('button');
          pageBtn.className = `pagination-btn px-3 py-2 rounded-lg font-semibold bitter-semibold transition-colors ${i === currentPage ? 'bg-primary text-secondary' : 'bg-white text-primary hover:bg-primary hover:bg-opacity-10'}`;
          pageBtn.textContent = i;
          pageBtn.addEventListener('click', () => {
            currentPage = i;
            initTable();
          });
          paginationContainer.appendChild(pageBtn);
        }
        
        // Next button
        if (currentPage < totalPages) {
          const nextBtn = document.createElement('button');
          nextBtn.className = 'pagination-btn bg-white text-primary px-3 py-2 rounded-lg font-semibold bitter-semibold hover:bg-primary hover:bg-opacity-10 transition-colors';
          nextBtn.innerHTML = `
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
          `;
          nextBtn.addEventListener('click', () => {
            currentPage++;
            initTable();
          });
          paginationContainer.appendChild(nextBtn);
        }
      }
      
      // Update showing info
      function updateShowingInfo() {
        const startIndex = (currentPage - 1) * rowsPerPage + 1;
        const endIndex = Math.min(currentPage * rowsPerPage, filteredData.length);
        
        document.getElementById('showing-start').textContent = startIndex;
        document.getElementById('showing-end').textContent = endIndex;
        document.getElementById('total-rows').textContent = filteredData.length;
      }
      
      // Search functionality
      const searchInput = document.getElementById('search-input');
      
      searchInput.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        
        if (searchTerm === '') {
          filteredData = [...sampleData];
        } else {
          filteredData = sampleData.filter(item => 
            item.customer.toLowerCase().includes(searchTerm)
          );
        }
        
        currentPage = 1;
        initTable();
      });
      
      // Rows per page functionality
      const rowsPerPageSelect = document.getElementById('rows-per-page');
      
      rowsPerPageSelect.addEventListener('change', function() {
        rowsPerPage = parseInt(this.value);
        currentPage = 1;
        initTable();
      });
      
      // Filter tanggal functionality
      const filterBtn = document.getElementById('filter-btn');
      const startDateInput = document.getElementById('start-date');
      const endDateInput = document.getElementById('end-date');
      
      // Set default dates (7 days ago to today)
      const today = new Date();
      const sevenDaysAgo = new Date();
      sevenDaysAgo.setDate(today.getDate() - 7);
      
      startDateInput.valueAsDate = sevenDaysAgo;
      endDateInput.valueAsDate = today;
      
      filterBtn.addEventListener('click', function() {
        const startDate = startDateInput.value;
        const endDate = endDateInput.value;
        
        if (!startDate || !endDate) {
          alert('Harap pilih tanggal mulai dan tanggal akhir');
          return;
        }
        
        // Filter data berdasarkan tanggal
        filteredData = sampleData.filter(item => {
          const itemDate = new Date(item.tanggal.split(' ')[0]); // Ambil hanya tanggalnya
          const filterStartDate = new Date(startDate);
          const filterEndDate = new Date(endDate);
          
          return itemDate >= filterStartDate && itemDate <= filterEndDate;
        });
        
        currentPage = 1;
        initTable();
      });
      
      // Initialize the table
      initTable();
    });
  </script>
</body>
</html>